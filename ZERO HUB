-- ZERO HUB - SISTEMA AUTO QUEST INTELIGENTE
local QuestTab = CreateTab("üéØ AUTO QUEST")

-- BASE DE DATOS DE NPCS POR NIVEL
local QuestNPCs = {
    -- First Sea
    {
        Name = "Bandit Leader",
        NPC = "Bandit Leader",
        Island = "Starter Island",
        Level = "0-10",
        CFrame = CFrame.new(1050, 50, 1600),
        Enemy = "Bandits",
        Sea = 1
    },
    {
        Name = "Monkey Trainer",
        NPC = "Adventurer", 
        Island = "Jungle",
        Level = "15-30",
        CFrame = CFrame.new(-1500, 70, -200),
        Enemy = "Monkeys, Gorillas",
        Sea = 1
    },
    {
        Name = "Pirate Captain",
        NPC = "Pirate Adventurer",
        Island = "Pirate Village", 
        Level = "30-60",
        CFrame = CFrame.new(-1150, 50, 3850),
        Enemy = "Pirates, Brutes",
        Sea = 1
    },
    {
        Name = "Desert Bandit",
        NPC = "Desert Adventurer",
        Island = "Desert",
        Level = "60-90", 
        CFrame = CFrame.new(950, 50, 4100),
        Enemy = "Desert Bandits",
        Sea = 1
    },
    {
        Name = "Snow Warrior",
        NPC = "Villager",
        Island = "Frozen Village",
        Level = "90-120",
        CFrame = CFrame.new(1150, 150, -1250),
        Enemy = "Snow Bandits, Yeti",
        Sea = 1
    },
    {
        Name = "Marine Officer", 
        NPC = "Vice Admiral's Assistant",
        Island = "Marine Fortress",
        Level = "120-150",
        CFrame = CFrame.new(-4850, 331, -360),
        Enemy = "Marine Officers",
        Sea = 1
    }
    -- Puedes seguir agregando m√°s NPCs aqu√≠
}

-- VARIABLES GLOBALES
getgenv().AutoQuestEnabled = false
getgenv().CurrentQuestNPC = nil
getgenv().QuestFarmEnabled = false

-- CONFIGURACI√ìN PRINCIPAL
_G.Settings = {
    -- Quest Settings
    ['Auto Quest'] = true,
    ['Auto Farm'] = true,
    ['Fast Attack'] = true,
    ['Auto Skills'] = true,
    
    -- Configuraciones de Pelea
    ['Distance Mob'] = 5,
    ['Mob Select'] = "Closest",
    ['Lock Mob'] = true,
    
    -- Frutas
    ['Auto Store Fruits'] = true,
    ['Auto Raid'] = true,
    ['Auto Buy Race'] = true,
    
    -- Miscel√°neos
    ['White Screen'] = false,
    ['FPS Boost'] = true,
    ['Auto Rejoin'] = true
}

-- FUNCI√ìN PARA OBTENER NIVEL DEL JUGADOR
function GetPlayerLevel()
    local success, level = pcall(function()
        return Player.Data.Level.Value
    end)
    return success and level or 1
end

-- FUNCI√ìN PARA ENCONTRAR NPC √ìPTIMO
function FindOptimalNPC()
    local playerLevel = GetPlayerLevel()
    local currentSea = 1 -- Puedes detectar el sea autom√°ticamente
    
    for _, npcData in pairs(QuestNPCs) do
        if npcData.Sea == currentSea then
            local minLevel = tonumber(npcData.Level:match("(%d+)"))
            local maxLevel = tonumber(npcData.Level:match("%d+%-(%d+)")) or minLevel + 50
            
            if playerLevel >= minLevel and playerLevel <= maxLevel then
                return npcData
            end
        end
    end
    return QuestNPCs[1] -- Fallback
end

-- FUNCI√ìN PARA TELEPORTAR A NPC
function TeleportToNPC(npcData)
    pcall(function()
        Player.Character:SetPrimaryPartCFrame(npcData.CFrame * CFrame.new(0, 0, -5))
        
        game:GetService("StarterGui"):SetCore("SendNotification",{
            Title = "üéØ ZERO HUB",
            Text = "Viajando a: " .. npcData.Name,
            Duration = 3
        })
        
        print("üìç Teleportando a: " .. npcData.Name .. " | Nivel: " .. npcData.Level)
    end)
end

-- FUNCI√ìN PARA FARMER ENEMIGOS DE QUEST
function FarmQuestEnemies(enemyType)
    pcall(function()
        local enemies = workspace:FindFirstChild("Enemies")
        if enemies then
            for _, enemy in pairs(enemies:GetChildren()) do
                if getgenv().QuestFarmEnabled and enemy:FindFirstChild("Humanoid") and enemy.Humanoid.Health > 0 then
                    if string.find(enemy.Name:lower(), enemyType:lower()) or enemyType == "All" then
                        Player.Character:SetPrimaryPartCFrame(enemy.HumanoidRootPart.CFrame * CFrame.new(0, 0, -8))
                        wait(0.3)
                        
                        -- Atacar con todas las herramientas
                        for _, tool in pairs(Player.Character:GetChildren()) do
                            if tool:IsA("Tool") then
                                tool:Activate()
                            end
                        end
                        break
                    end
                end
            end
        end
    end)
end

-- UI ELEMENTS
QuestTab:AddToggle({
    Name = "Auto Quest Inteligente",
    Default = false,
    Callback = function(Value)
        getgenv().AutoQuestEnabled = Value
        if Value then
            AutoQuestSystem()
        end
    end
})

QuestTab:AddButton({
    Name = "üîç Buscar NPC √ìptimo",
    Callback = function()
        local optimalNPC = FindOptimalNPC()
        getgenv().CurrentQuestNPC = optimalNPC
        
        game:GetService("StarterGui"):SetCore("SendNotification",{
            Title = "üéØ ZERO HUB",
            Text = optimalNPC.Name .. " | Nivel " .. optimalNPC.Level,
            Duration = 5
        })
    end
})

-- Sistema Auto Quest Principal
function AutoQuestSystem()
    spawn(function()
        while getgenv().AutoQuestEnabled do
            pcall(function()
                local optimalNPC = FindOptimalNPC()
                getgenv().CurrentQuestNPC = optimalNPC
                
                -- Teleportar al NPC
                TeleportToNPC(optimalNPC)
                
                -- Esperar y activar farmeo
                wait(3)
                getgenv().QuestFarmEnabled = true
                
                -- Farmear enemigos
                spawn(function()
                    while getgenv().QuestFarmEnabled and getgenv().AutoQuestEnabled and wait(0.5) do
                        FarmQuestEnemies(optimalNPC.Enemy)
                    end
                end)
                
                wait(30) -- Esperar 30 segundos antes de re-evaluar
            end)
            wait(1)
        end
    end)
end

-- Anti AFK
game:GetService("Players").LocalPlayer.Idled:connect(function()
    game:GetService("VirtualUser"):Button2Down(Vector2.new(0, 0), workspace.CurrentCamera.CFrame)
    wait(1)
    game:GetService("VirtualUser"):Button2Up(Vector2.new(0, 0), workspace.CurrentCamera.CFrame)
end)

-- Inicializaci√≥n
spawn(function()
    wait(3)
    local optimalNPC = FindOptimalNPC()
    getgenv().CurrentQuestNPC = optimalNPC
    
    print("üéØ ZERO HUB - AUTO QUEST INICIADO")
    print("üìç NPC Inicial: " .. optimalNPC.Name)
    print("üìä Nivel Recomendado: " .. optimalNPC.Level)
    print("üèùÔ∏è Isla: " .. optimalNPC.Island)
    print("‚öîÔ∏è Enemigos: " .. optimalNPC.Enemy)
end)
